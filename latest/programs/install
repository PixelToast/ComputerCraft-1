-- CraftOS+ Install Program
if fs.exists("bin/latest") == true then
 file = fs.open("bin/latest", "r")
 text = file.readLine()
 file.close()
 if text == "true" then
  version = "latest"
 end
else
 version = "recommended"
end
program = "installer"
local fileLocation = "https://raw.github.com/Sirharry0077/ComputerCraft/master/"..version.."/programs/"..program

local function fetchFile()
 http.request(fileLocation)
 local requesting = true
 while requesting do
  local event, url, sourceText = os.pullEvent()
  if event == "http_success" then
   local respondedText = sourceText.readAll()
   requesting = false
   local download = http.get(fileLocation)
   local text = download.readAll()
   download.close()
   file = fs.open(program, "w")
   file.write(text)
   file.close()
   success = true
  elseif event == "http_failure" then
   print("Server didn't respond.")
   requesting = false
   success = false
  end
 end
end

rednet.open("top")
shell.run("clear")
print("Install")
print("-------")

fetchFile()
if success == true then
 shell.run("installer")
 fs.delete("installer")
 os.reboot()
else
 print("Please Try Again")
end
