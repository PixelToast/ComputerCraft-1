-- CraftOS+ Installer
local error = 0

local function fetchFile()
 http.request(fileLocation)
 local requesting = true
 while requesting do
  local event, url, sourceText = os.pullEvent()
  if event == "http_success" then
   local respondedText = sourceText.readAll()
   requesting = false
   local download = http.get(fileLocation)
   local text = download.readAll()
   download.close()
   file = fs.open(program, "w")
   file.write(text)
   file.close()
   success = true
  elseif event == "http_failure" then
   print("Server didn't respond.")
   error = error + 1
   requesting = false
  end
 end
end

rednet.open("top")
shell.run("clear")
print("CraftOS+ Updater/Installer")
print("--------------------------")
print("Press ENTER To Proceed")
read()
x = 1
error = 0
errors = "PLACEHOLDER"
repeat
 if x == 1 then
  program = "startup"
 elseif x == 2 then
  program = "install"
 elseif x == 3 then
  program = "download"
 elseif x == 4 then
  program = "upload"
 elseif x == 5 then
  program = "stop"
 elseif x == 6 then
  program = "semistartup"
 end

 if latest == true then
  local fileLocation = "https://raw.github.com/Sirharry0077/ComputerCraft/master/latest/programs/"..program
 else
  local fileLocation = "https://raw.github.com/Sirharry0077/ComputerCraft/master/recommended/programs/"..program
 end
 print("Waiting For ", program, "...")
 
 file = fs.open(program, "w")
 file.write(filetext)
 file.close()
 x = x + 1
until x == 7

if error == 0 or error > 1 then
 errors = " Errors."
elseif x == 1 then
 erros = " Error."
end

print("Installation Complete With ", error, errors)
print("If There Was Any Errors, Please Restart The Installer.")
print("Press ENTER To Continue.")
read()